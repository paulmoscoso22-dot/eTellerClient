<div class="container">
  <h1>Giornale di Cassa</h1>

  <!-- Search Form -->
  <div class="search-form" [formGroup]="searchForm">
    <div class="form-row">
      <div class="form-group">
        <dx-text-box
          id="trxCassa"
          formControlName="trxCassa"
          placeholder="Codice Cassa"
          label="Cassa"
        ></dx-text-box>
      </div>

      <div class="form-group">
        <dx-text-box
          id="trxBraId"
          formControlName="trxBraId"
          placeholder="Codice Filiale"
          label="Filiale"
        ></dx-text-box>
      </div>

      <div class="form-group">
        <dx-number-box
          id="trxStatus"
          formControlName="trxStatus"
          placeholder="Status"
          label="Status"
        ></dx-number-box>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <dx-date-box
          id="trxDataDal"
          formControlName="trxDataDal"
          type="date"
          label="Data Dal"
          format="dd/MM/yyyy"
          displayFormat="dd/MM/yyyy"
        ></dx-date-box>
      </div>

      <div class="form-group">
        <dx-date-box
          id="trxDataAl"
          formControlName="trxDataAl"
          type="date"
          label="Data Al"
          format="dd/MM/yyyy"
          displayFormat="dd/MM/yyyy"
        ></dx-date-box>
      </div>
    </div>

    <div class="form-group button-group">
        <dx-button
          text="Ricerca"
          type="success"
          (onClick)="search()"
          [disabled]="isLoading()"
        ></dx-button>
      </div>
  </div>

  <!-- Error Message -->
  @if (error()) {
    <div class="error-message">
      {{ error() }}
    </div>
  }

  <!-- Loading Indicator -->
  @if (isLoading()) {
    <div class="loading-message">
      Caricamento...
    </div>
  }

  <!-- Data Grid -->
  @if (!isLoading() && transactions().length > 0) {
    <div class="data-grid-container">
    <dx-data-grid
      [dataSource]="transactions()"
      keyExpr="trxId"
      [showBorders]="true"
      [columnAutoWidth]="true"
      [allowColumnReordering]="true"
      [allowColumnResizing]="true"
    >
      <dxo-paging [pageSize]="10" [enabled]="true"></dxo-paging>
      <dxo-pager [showPageSizeSelector]="true" [allowedPageSizes]="[10, 25, 50, 100]" [showInfo]="true"></dxo-pager>
      <dxi-column dataField="trxId" caption="ID" width="60"></dxi-column>
      <dxi-column dataField="trxCassa" caption="Cassa" width="80"></dxi-column>
      <dxi-column dataField="trxBraId" caption="Filiale" width="80"></dxi-column>
      <dxi-column dataField="trxNumrel" caption="Numero Relazione" width="120"></dxi-column>
      <dxi-column dataField="trxCtoope" caption="Conto Operante" width="120"></dxi-column>
      <dxi-column dataField="trxImpctp" caption="Importo CTP" width="100" dataType="number"></dxi-column>
      <dxi-column dataField="trxImpope" caption="Importo Operazione" width="120" dataType="number"></dxi-column>
      <dxi-column dataField="trxDatope" caption="Data Operazione" width="130" dataType="datetime" format="dd/MM/yyyy"></dxi-column>
      <dxi-column dataField="trxStatus" caption="Status" width="70"></dxi-column>
      <dxi-column dataField="trxUsrId" caption="Utente" width="80"></dxi-column>
      <dxi-column dataField="trxOnline" caption="Online" width="35" dataType="boolean"></dxi-column>
    </dx-data-grid>
    </div>
  }

  <!-- No Data Message -->
  @if (!isLoading() && transactions().length === 0 && !error()) {
    <div class="no-data-message">
      Nessuna transazione trovata
    </div>
  }
</div>
